# Diagrama de Fluxo: Instalação de Skills

## Fluxo Completo: `specswift init`

```
┌─────────────────────────────────────────────────────────────┐
│  specswift init ~/project --editor windsurf --lang pt        │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  1. Verificação de Dependências                             │
│     - Homebrew, Git, xcodegen (se necessário)               │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  2. Criação do Diretório do Projeto                         │
│     mkdir -p ~/project                                       │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  3. Cópia de Recursos (na ordem)                            │
│                                                              │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_workflows()                                   │    │
│  │ → .windsurf/workflows/*.md                         │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_rules()                                        │    │
│  │ → .windsurf/rules/*.md                              │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_templates()                                  │    │
│  │ → _docs/templates/*.md                             │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_scripts()                                     │    │
│  │ → _docs/scripts/bash/*.sh                          │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_documentation()                               │    │
│  │ → _docs/SPECSWIFT-WORKFLOWS.md                      │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_skills()  ⭐ NOVO                             │    │
│  │ → .windsurf/skills/*/                               │    │
│  │                                                      │    │
│  │ Condição: if [[ "$editor" == "windsurf" ]]         │    │
│  │                                                      │    │
│  │ Fluxo interno:                                      │    │
│  │   1. Determina diretório: .windsurf/skills/        │    │
│  │   2. Seleciona idioma: lib/skills/pt/ ou en/       │    │
│  │   3. Para cada skill em lib/skills/pt/*/:          │    │
│  │      - Copia diretório completo recursivamente      │    │
│  │      - Mantém estrutura: SKILL.md, checklists/, etc│    │
│  └────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  4. Criação do Makefile                                     │
│     (se não existir)                                        │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  5. Inicialização do Git                                     │
│     (se --no-git não for usado)                            │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  6. Resumo Final                                            │
│     ✅ Projeto Criado!                                      │
└─────────────────────────────────────────────────────────────┘
```

## Fluxo Completo: `specswift install`

```
┌─────────────────────────────────────────────────────────────┐
│  specswift install --editor windsurf                        │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  1. Verificação de Instalação Existente                     │
│     - Se .windsurf/workflows/ existe e --force não usado:  │
│       → Avisa e sai (a menos que --force)                   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  2. Cópia de Recursos (mesma ordem que init)                │
│                                                              │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_workflows()                                   │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_rules()                                      │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_templates()                                  │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_scripts()                                     │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_documentation()                               │    │
│  └────────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_skills()  ⭐ NOVO                             │    │
│  │                                                      │    │
│  │ Comportamento:                                      │    │
│  │   - Se skills já existem e --force não usado:       │    │
│  │     → Avisa mas não falha (skills são opcionais)    │    │
│  │   - Se --force usado:                               │    │
│  │     → Sobrescreve skills existentes                 │    │
│  └────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  3. Criação do Makefile                                     │
│     (apenas se não existir)                                 │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  4. Resumo Final                                            │
│     ✅ SpecSwift Instalado!                                 │
└─────────────────────────────────────────────────────────────┘
```

## Fluxo Completo: `specswift update`

```
┌─────────────────────────────────────────────────────────────┐
│  specswift update                                           │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  1. Detecção do Editor                                      │
│     - Verifica .cursor/ ou .windsurf/                      │
│     - Se nenhum encontrado: erro                           │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  2. Atualização de Recursos (sempre sobrescreve)            │
│                                                              │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_workflows(..., true)  # overwrite=true      │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_templates(..., true)  # overwrite=true       │    │
│  └────────────────────────────────────────────────────┘    │
│                            │                                │
│                            ▼                                │
│  ┌────────────────────────────────────────────────────┐    │
│  │ _copy_skills(..., true)  ⭐ NOVO                    │    │
│  │                                                      │    │
│  │ Condição: if [[ "$editor" == "windsurf" ]]         │    │
│  │ Comportamento: Sempre sobrescreve (overwrite=true) │    │
│  └────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  3. Atualização de Documentação                             │
│     - Copia SPECSWIFT-WORKFLOWS.md                         │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  4. Resumo Final                                            │
│     ✅ SpecSwift atualizado para v1.0.0                    │
└─────────────────────────────────────────────────────────────┘
```

## Estrutura de Diretórios: Antes e Depois

### Antes (sem skills)

```
projeto/
├── .windsurf/
│   ├── workflows/
│   │   └── specswift.*.md
│   └── rules/
│       └── *.md
├── _docs/
│   ├── templates/
│   ├── scripts/
│   └── SPECSWIFT-WORKFLOWS.md
└── Makefile
```

### Depois (com skills)

```
projeto/
├── .windsurf/
│   ├── workflows/
│   │   └── specswift.*.md
│   ├── rules/
│   │   └── *.md
│   └── skills/  ⭐ NOVO
│       ├── prd-quality-validation/
│       │   ├── SKILL.md
│       │   └── checklists/
│       │       └── prd-quality-checklist.md
│       └── feature-setup/
│           ├── SKILL.md
│           └── scripts/
├── _docs/
│   ├── templates/
│   ├── scripts/
│   └── SPECSWIFT-WORKFLOWS.md
└── Makefile
```

## Decisões de Fluxo

### Quando copiar skills?

```
┌─────────────────────────────────────┐
│  Editor selecionado?                │
└─────────────────────────────────────┘
            │
    ┌───────┴───────┐
    │               │
    ▼               ▼
┌─────────┐    ┌─────────┐
│ Cursor  │    │Windsurf │
└─────────┘    └─────────┘
    │               │
    │               ▼
    │        ┌──────────────┐
    │        │ Copiar Skills │
    │        └──────────────┘
    │
    ▼
┌─────────┐
│  Pular  │
└─────────┘
```

### Comportamento de sobrescrita

```
┌─────────────────────────────────────┐
│  Comando executado?                │
└─────────────────────────────────────┘
            │
    ┌───────┴───────┐
    │               │
    ▼               ▼
┌─────────┐    ┌─────────┐
│  init   │    │ install │
└─────────┘    └─────────┘
    │               │
    │               │
    ▼               ▼
┌─────────┐    ┌─────────┐
│ Sempre  │    │ Verifica│
│ copia   │    │ existência│
└─────────┘    └─────────┘
                    │
            ┌───────┴───────┐
            │               │
            ▼               ▼
    ┌───────────┐    ┌───────────┐
    │ Existe?   │    │ --force?  │
    └───────────┘    └───────────┘
            │               │
            │               ▼
            │        ┌───────────┐
            │        │ Sobrescreve│
            │        └───────────┘
            │
            ▼
    ┌───────────┐
    │  Avisa    │
    │  (não falha)│
    └───────────┘
```

## Resumo Visual

```
┌─────────────────────────────────────────────────────────┐
│                    specswift CLI                         │
│                                                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │    init      │  │   install   │  │    update    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│         │                 │                 │           │
│         └─────────────────┴─────────────────┘           │
│                         │                               │
│                         ▼                               │
│  ┌──────────────────────────────────────────────────┐  │
│  │         Funções de Cópia                         │  │
│  │                                                   │  │
│  │  _copy_workflows()                               │  │
│  │  _copy_rules()                                   │  │
│  │  _copy_templates()                               │  │
│  │  _copy_scripts()                                 │  │
│  │  _copy_documentation()                           │  │
│  │  _copy_skills()  ⭐ NOVO                          │  │
│  └──────────────────────────────────────────────────┘  │
│                         │                               │
│                         ▼                               │
│  ┌──────────────────────────────────────────────────┐  │
│  │         Estrutura no Projeto                      │  │
│  │                                                   │  │
│  │  .windsurf/                                       │  │
│  │    ├── workflows/                                │  │
│  │    ├── rules/                                    │  │
│  │    └── skills/  ⭐ NOVO                           │  │
│  │                                                   │  │
│  │  _docs/                                           │  │
│  │    ├── templates/                                │  │
│  │    ├── scripts/                                 │  │
│  │    └── SPECSWIFT-WORKFLOWS.md                    │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```
